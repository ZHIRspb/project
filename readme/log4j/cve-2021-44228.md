# CVE-2021-44228

### Материалы:

* [https://nvd.nist.gov/vuln/detail/CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)
* [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228)
* [https://securelist.ru/cve-2021-44228-vulnerability-in-apache-log4j-library/104144/](https://securelist.ru/cve-2021-44228-vulnerability-in-apache-log4j-library/104144/)

Уязвимость удаленного выполнения кода CVE-2021-44228 была обнаружена в библиотеке Apache Log4j части Apache Logging Project. Если какой-либо продукт для записи файлов журналов использует уязвимую версию данной библиотеки с поставляемым JNDI-модулем, то есть большая вероятность эксплуатации CVE-2021-44228 в этом продукте. Уязвимы почти все версии Log4j, начиная с 2.0-beta9 и заканчивая 2.14.1.\
Библиотека Log4j имеет механизм Lookup, который используется для выполнения запросов путем обработки специального синтаксиса в форматной строке. Например, с помощью него можно запрашивать различные параметры, такие как версия окружения Java через _${java:version}_ и т. д. При этом если указать в строке в качестве ключа _jndi_, то механизм Lookup будет осуществляться через JNDI API. По умолчанию все запросы осуществляются с префиксом _java:comp/env/_, однако авторы предусмотрели возможность указания собственного префикса — для этого в ключе надо поставить символ двоеточия. Здесь и кроется уязвимость: если указать в качестве ключа, например, _jndi:ldap://_, то запрос будет осуществляться на указанный LDAP-сервер. Также возможно использование и других протоколов для взаимодействия, например LDAPS, DNS, RMI.

### Эксплуатация уязвимости

> Контейнер с уязвимой средой находится в директории /home/user/Hackathon/vulhub-master/log4j/CVE-2021-44228

Для запуска уязвимой среды выполните команду:

```
docker compose up -d
```

После запуска по адресу http://ваш-ip:8983 будет доступен портал администратора Apache Solr

\---- скрин ----

поднятие jndi-сервера

\---- скрин ----&#x20;

обращение к нему и выполнение произвольного кода

\---- скрин ----

вазух&#x20;

\---- скрин вазух ----

