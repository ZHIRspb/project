# CVE-2020-7247

OpenSMTPD — это сервисная программа smtp для операционных систем unix (BSD, MacOS, GNU/Linux), следующая протоколу SMTP RFC 5321. OpenSMTPD изначально был разработан для операционной системы OpenBSD и является частью проекта OpenBSD. Благодаря свойствам открытого исходного кода распространяется на другие платформы Unix. Причиной возникновения CVE-2020-7247  является слабая проверка отправителя/получателя OpenSMTPD в процессе реализации RFC 5321.

### Эксплуатация уязвимости

Для запуска уязвимой среды выполните команду:

```
docker compose up -d
```

После запуска проверьте подключение к SMTPD серверу с помощью команды:

```
nc ваш-ip 8825 -v
```

<figure><img src="../../.gitbook/assets/image.png" alt=""><figcaption><p>cd4edbb07e6d - ID контейнера</p></figcaption></figure>

Для реализации уязвимости используйте готовый эксплоит на [exploitDB](https://www.exploit-db.com/exploits/47984)

<figure><img src="../../.gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

После выполнения команды на уязвимой машине был создан файл /tmp/success

<figure><img src="../../.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

В Wazuh (https://ваш-ip/app/wazuh) мы можем увидеть соответствующие алерты от IDS Suricata об эксплуатации данной уязвимости.

<figure><img src="../../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>
