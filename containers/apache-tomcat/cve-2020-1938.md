# CVE-2020-1938

Apache Tomcat — это комплект серверных программ от Apache Software Foundation, предназначенный для тестирования, отладки и исполнения веб-приложений на основе Java.

Ghostcat — серьезная уязвимость в Tomcat, обнаруженная исследователем безопасности компании Chaitin Tech. Из-за ошибки в протоколе Tomcat AJP злоумышленник может читать или включать любые файлы в каталоги веб-приложений Tomcat. Например, злоумышленник может прочитать файлы конфигурации веб-приложения или исходный код.

### Эксплуатация уязвимости

Для запуска уязвимой среды выполните команду:&#x20;

```
docker compose up -d
```

После запуска по адресу http://ваш-ip:8080 будет доступна стандартная страница Apache Tomcat&#x20;

<figure><img src="../../.gitbook/assets/image (35).png" alt=""><figcaption></figcaption></figure>

Также будет открыт 8009 порт для протокола Tomcat AJP

<figure><img src="../../.gitbook/assets/image (37).png" alt=""><figcaption></figcaption></figure>

Протестировать уязвимость можно с помощью данного [эксплойта](https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi/blob/master/CNVD-2020-10487-Tomcat-Ajp-lfi.py)

Например, можно просмотреть код страницы:

```
python2 CNVD-2020-10487-Tomcat-Ajp-lfi.py -p 8009 -f /WEB-INF/web.xml ваш-ip
```

<figure><img src="../../.gitbook/assets/image (38).png" alt=""><figcaption></figcaption></figure>

В Wazuh (https://ваш-ip/app/wazuh) мы можем увидеть соответствующие алерты от IDS Suricata об эксплуатации данной уязвимости.

<figure><img src="../../.gitbook/assets/image (39).png" alt=""><figcaption></figcaption></figure>
